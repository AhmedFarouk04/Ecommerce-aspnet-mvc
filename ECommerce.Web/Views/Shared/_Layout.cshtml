<!DOCTYPE html>
<html lang="en" class="bg-light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>@ViewData["Title"] - E-Commerce</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css" rel="stylesheet" />

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/site.css" />
</head>

<body>

    @await Html.PartialAsync("_Header")

    <main class="container py-4" style="min-height: 78vh;">
        @RenderBody()
        <partial name="_Alerts" />
    </main>

    @await Html.PartialAsync("_Footer")

    <div id="snackbar"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script src="~/js/cart.js"></script>

    <script>
        function showToast(message, type = "primary") {
            const bar = document.getElementById("snackbar");
            if (!bar) return;

            bar.innerText = message;

            const colors = {
                success: "#16a34a",
                danger: "#dc2626",
                warning: "#ca8a04",
                primary: "#3b82f6"
            };

            bar.style.backgroundColor = colors[type] || colors.primary;
            bar.className = "show";

            setTimeout(() => {
                bar.className = bar.className.replace("show", "");
            }, 3000);
        }

        @if (TempData["Success"] != null)
        {
                <text> showToast("@TempData["Success"]", "success"); </text>
        }

        @if (TempData["Error"] != null)
        {
                <text> showToast("@TempData["Error"]", "danger"); </text>
        }


                async function refreshCartUI() {
            const res = await fetch("/Cart/State");
            const data = await res.json();

            const badge = document.querySelector(".cart-count-badge");
            if (badge) {
                badge.textContent = data.count;
                badge.classList.toggle("d-none", data.count === 0);
            }
        }

            document.addEventListener("DOMContentLoaded", refreshCartUI);
    </script>

    @RenderSection("Scripts", required: false)


    
</body>
</html>
